version: '2'

services:
  boot:
    image: lydrin/mariadb-galera-5.5
    container_name: maria_boot
    command: sudo mysqld --wsrep-new-cluster
    ports:
      - 3306:3306
      - 4567:4567
      - 4568:4568
      - 4444:4444
    volumes:
      - ./boot:/etc/mysql/conf.d
      - ./sql_script:/script
    environment:
      - MYSQL_ROOT_PASSWORD=test
      - GALERA=On
      - NODE_NAME=boot

  node1:
    image: lydrin/mariadb-galera-5.5
    container_name: maria_node1
    command: sudo bash -c "sleep 3; mysqld"
    ports:
      - 3307:3306
      - 14567:4567
      - 14568:4568
      - 4445:4445
    volumes:
    - ./node1:/etc/mysql/conf.d
    environment:
      - MYSQL_ROOT_PASSWORD=test
      - GALERA=On
      - NODE_NAME=node1

  node2:
    image: lydrin/mariadb-galera-5.5
    container_name: maria_node2
    command: sudo bash -c "sleep 3; mysqld"
    ports:
      - 3308:3306
      - 24567:4567
      - 24568:4568
      - 4446:4446
    volumes:
    - ./node2:/etc/mysql/conf.d
    environment:
    - MYSQL_ROOT_PASSWORD=test
    - GALERA=On
    - NODE_NAME=node2


